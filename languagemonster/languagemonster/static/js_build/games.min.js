function setData(t,e,i){var s=e.split(/\./);s.length<2?t[s[0]]=i:(t[s[0]]||(t[s[0]]={}),t=t[s.shift()],setData(t,s.join("."),i))}function getData(t,e){var i=e.split(/\./);return i.length<2?t[i[0]]:(t[i[0]]||(t[i[0]]={}),t=t[i.shift()],getData(t,i.join(".")))}function newGame(){game=new MONSTER.Game(60)}var MONSTER=MONSTER||{};MONSTER.Const=function(){},MONSTER.Const.PI=3.14159265359,MONSTER.Const.PI_2=MONSTER.Const.PI/2,MONSTER.Const.AHEAD=1,MONSTER.Const.LEFT=2,MONSTER.Const.RIGHT=3,MONSTER.Const.FONTS={},MONSTER.Const.DEFAULT_FONT_FAMILY="Montserrat",MONSTER.Const.COLOURS={navy:"#160E41",white:"#ffffff"},MONSTER.initFonts=function(t,e,i){for(var s=MONSTER.Const.FONTS,o=0;o<t.length;o++){var n=t[o];s[n]=s[n]||{};for(var h=0;h<e.length;h++){var a=e[h];s[n][a]=s[n][a]||{};for(var r=0;r<i.length;r++){var p=i[r];s[n][a][p]={fontFamily:n,fontSize:parseInt(p),fill:a}}}}},MONSTER.getFonts=function(t,e){return MONSTER.Const.FONTS[t][e]},MONSTER.isZero=function(t){return Math.abs(t)<1e-6},MONSTER.linear=function(t,e,i,s,o){return t/(i-e)*(o-s)+s},MONSTER.Utils=function(){},MONSTER.Utils.objectValues=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(t[i]);return e},MONSTER.Utils.shuffle=function(t){for(var e,i,s=t.length;s;)i=Math.floor(Math.random()*s--),e=t[s],t[s]=t[i],t[i]=e;return t},MONSTER.Utils.replace_at=function(t,e,i){return t.substr(0,e)+i+t.substr(e+i.length)},MONSTER.Utils.to_radians=function(t){return t*MONSTER.Const.PI/180},MONSTER.Utils.isPointInRect=function(t,e,i){return MONSTER.Utils.isPointInRectWithTol(t,e,i,[0,0])},MONSTER.Utils.isPointInRectWithTol=function(t,e,i,s){var o=s[0]/100*i[2],n=s[1]/100*i[3];return t>=i[0]-o&&t<=i[0]+i[2]+o&&e>=i[1]-n&&e<=i[1]+i[3]+n},MONSTER.Utils.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},MONSTER.Utils.clamp=function(t,e,i){return t<=e?e:t>=i?i:t},MONSTER.Utils.bezier=function(t,e){var i=(1-t)*(1-t)*e[0].x+2*(1-t)*t*e[1].x+t*t*e[2].x,s=(1-t)*(1-t)*e[0].y+2*(1-t)*t*e[1].y+t*t*e[2].y;return{x:i,y:s}},MONSTER.Common=function(){},MONSTER.Common.correct=function(t){t.game.learned.push(t.current_pair.id),t.game.round_id<=t.game.actual_rounds&&t.game.points++,t.resultScreen(!0)},MONSTER.Common.negative=function(t){t.game.to_repeat.push(t.current_pair.id),t.game.to_ask.push(t.current_pair),t.resultScreen(!1)},MONSTER.Common.check_answer=function(t,e){e===t.answer?MONSTER.Common.correct(e):MONSTER.Common.negative(e)},MONSTER.Common._next_level=function(t){t.level_id++,t.next_level(),t.kick_off()},MONSTER.Common.keyup_handler=function(t,e){t.keyCode===MONSTER.Key.ENTER&&(document.removeEventListener("keyup",MONSTER.Common._continue_handler),delete MONSTER.Common._continue_handler,MONSTER.Common._next_level(e))},MONSTER.Common.endScreen=function(t){var e=t;t.game.view.removeChildren();var i=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.white),s=PIXI.Texture.fromImage(t.game.assets.ui.ui_star),o=PIXI.Texture.fromImage(t.game.assets.ui.ui_dark_star);t.game.pct=Math.round(t.game.points/t.game.all.length*100);var n=t.game.pct>=75?3:t.game.pct>=45?2:1,h=[],a=0;for(a=0;a<n;a++)h.push(new PIXI.Sprite(s));for(a=h.length;a<3;a++)h.push(new PIXI.Sprite(o));var r=new PIXI.Text("",i[30]);r.text=MONSTER.Common.trans("Well done",window.translations),r.position.x=(t.game.width-r.width)/2,r.position.y=.15*t.game.height,t.info=new PIXI.Text(MONSTER.Common.trans("Sending results...",window.translations),i[16]),t.info.position.x=(t.game.width-t.info.width)/2,t.info.position.y=.89*t.game.height,t.b=MONSTER.Common.createButton(e,MONSTER.Common.trans("Continue",window.translations),0,0,200,100,(t.game.width-200)/2,.6*t.game.height,function(){MONSTER.Common._next_level(t.game)}),t.game.view.addChild(r),t.game.view.addChild(t.info);var p=new PIXI.Container,c=h[0].width+Math.round(.1*h[0].height);for(a=0;a<h.length;a++)h[a].position.x=a*c,p.addChild(h[a]);h[0].position.y=h[2].position.y=h[0].position.y+=Math.round(.25*h[0].height),p.position.x=(t.game.width-3*c)/2,p.position.y=Math.round(.28*t.game.height),t.game.view.addChild(p),MONSTER.Common.sendResults(t)},MONSTER.Common.cancelAnimationFrame=function(t){var e=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.msCancelAnimationFrame;return e(t)},MONSTER.Common.getWordSet=function(t){var e=t.game;if(e.round_id===e.to_ask.length)return!1;var i=e.to_ask[e.round_id];e.round_id++;var s=0,o=1;t.current_pair=i,t.question=i.words[s],t.answer=i.words[o],t.choices=[],t.choices.push(t.answer),MONSTER.Utils.shuffle(e.all);for(var n=0;n<e.all.length&&(e.all[n].id!=t.current_pair.id&&t.choices.push(e.all[n].words[o]),4!=t.choices.length);n++);if(t.choices=MONSTER.Utils.shuffle(t.choices),4!=t.choices.length)throw"Not enough choices";return!0},MONSTER.Common.getLoader=function(){var t=PIXI.loader;return t.reset(),t},MONSTER.Common.showTutorial=function(t){if(t.currentScreen){var e=window.games_played,i=t.currentScreen.ID;e.indexOf(i)<0&&(e.push(i),MONSTER.Common._showTutorial(t,t.tutorial))}},MONSTER.Common._showTutorial=function(t,e){$("#"+e).modal("show"),t.pause=!0,t.currentScreen.onGamePause()},MONSTER.Common.hideCursor=function(){document.body.style.cursor="none"},MONSTER.Common.showCursor=function(){document.body.style.cursor="default"},MONSTER.Common.addUI=function(t){var e=PIXI.Sprite.fromImage(t.assets.ui.ui_btn_info);if(e.scale.x=e.scale.y=.65,e.interactive=!0,t.currentScreen){var i=t.tutorial;e.click=function(){MONSTER.Common._showTutorial(t,i)},e.mouseover=function(){document.body.style.cursor="pointer"},e.mouseout=function(){document.body.style.cursor="default"},$("#"+i).on("hide.bs.modal",function(){t.pause=!1,t.currentScreen.onGamePauseOff()}),t.view.addChild(e)}},MONSTER.Common.getAnswersMinusCurrent=function(t,e){for(var i=[],s=0;s<t.length;s++)t[s].text.text!==e.text.text&&i.push(t[s]);return i},MONSTER.Common.fillBackground=function(t,e){t.game.background.beginFill(e,1),t.game.background.drawRect(0,0,t.game.width,t.game.height),t.game.background.endFill()},MONSTER.Common.getCookie=function(t){var e=null;if(document.cookie&&""!==document.cookie)for(var i=document.cookie.split(";"),s=0;s<i.length;s++){var o=jQuery.trim(i[s]);if(o.substring(0,t.length+1)==t+"="){e=decodeURIComponent(o.substring(t.length+1));break}}return e},MONSTER.Common.setUpAjax=function(){$.ajaxSetup({beforeSend:function(t,e){/^http:.*/.test(e.url)||/^https:.*/.test(e.url)||t.setRequestHeader("X-CSRFToken",MONSTER.Common.getCookie("csrftoken"))}})},MONSTER.Common.secure_answer_size=function(t,e,i){var s=18,o=t.text.length;if(t.text.indexOf(" ")!=-1&&o>s){var n=Math.floor(o/s),h=Math.floor(.66*s),a=0;if(n>0)for(var r=0;r<o&&(" "==t.text[r]&&r-a>h&&(a=r,t.text=MONSTER.Utils.replace_at(t.text,r,"\n"),n--),0!==n);r++);}for(var p=0;p<e.length&&(t.style=e[p],!(t.width<=i));p++);},MONSTER.Common.createButton=function(t,e,i,s,o,n,h,a,r){var p=new PIXI.Graphics;p.position.x=h,p.position.y=a,p.beginFill(t.button_colors.active),p.drawRect(i,s,o,n),p.endFill(),p.interactive=!1,p.hitArea=new PIXI.Rectangle(i,s,o,n),p.text=e;var c=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.white),m=[c[26],c[22],c[16],c[12]],d=new PIXI.Text(e,m[0]),l=function(t){for(var e=0;e<m.length&&(d.style=m[e],d.position.x=i+(o-d.width)/2,d.position.y=s+(n-d.height)/2+2,!(d.width<=t));e++);};return l(o),p.addChild(d),p.click=function(){p.clear(),p.beginFill(t.button_colors.click),p.drawRect(i,s,o,n,3),p.endFill(),r()},p.mouseover=function(){p.clear(),p.beginFill(t.button_colors.hover),p.drawRect(i,s,o,n,3),p.endFill(),document.body.style.cursor="pointer"},p.mouseout=function(){p.clear(),p.beginFill(t.button_colors.active),p.drawRect(i,s,o,n,3),p.endFill(),document.body.style.cursor="default"},p},MONSTER.Common.sendResults=function(t){$.ajax({method:"POST",crossDomain:!1,url:"/api/local/users/results",contentType:"application/json",data:JSON.stringify({dataset_id:t.game.data.dataset_id,email:t.game.data.email,mark:t.game.pct,words_learned:t.game.learned,to_repeat:t.game.to_repeat,game:t.ID}),dataType:"json"}).success(function(){t.info.text=MONSTER.Common.trans("Results were sent",window.translations),t.info.position.x=(t.game.width-t.info.width)/2,MONSTER.Common._continue_handler=function(e){MONSTER.Common.keyup_handler(e,t.game)},document.addEventListener("keyup",MONSTER.Common._continue_handler,!1),t.game.view.addChild(t.b),t.b.interactive=!0}).error(function(){t.info.text=MONSTER.Common.trans("Error when sending results",window.translations),t.info.position.x=(t.game.width-t.info.width)/2})},MONSTER.Common.trans=function(t,e){return t in e?e[t]:t},MONSTER.Common.parallax=function(t,e,i,s){for(var o=0;o<e.length;o++)for(var n=e[o],h=i[o],a=0;a<n.length;a++){var r=n[a];if(r.position.x-=h*t,r.position.x<=-s){var p=n.shift();p.position.x=s,n.push(p)}}},MONSTER.GoodWrongScreen=function(t,e,i){var s=new PIXI.Container,o=new PIXI.Graphics;o.beginFill(16777215,.8),o.drawRect(e.show,i.y,i.width,i.height),o.endFill();var n=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.white),h=new PIXI.Text("",n[30]),a=new PIXI.Text("",n[36]),r=new PIXI.Text("",n[30]),p=new PIXI.Text("",n[30]),c=new PIXI.Text("",n[30]);return a.position.y=(t.height-a.height)/2,h.position.y=(t.height-h.height)/4,s.addChild(o),o.addChild(a),o.addChild(h),o.addChild(r),o.addChild(p),o.addChild(c),{box:s,pos_screen:o,pos_screen_comment:h,pos_screen_text:a,pos_screen_text_line1:r,pos_screen_text_line2:p,pos_screen_text_line3:c}},MONSTER.GoodWrongScreen.prepare=function(t,e){var i=t.box;i.pos_screen_text.text=t.question+" = "+t.answer,i.pos_screen_text.width>.8*t.game.width?(i.pos_screen_text.text="",i.pos_screen_text_line1.text=t.question,i.pos_screen_text_line2.text="=",i.pos_screen_text_line3.text=t.answer,i.pos_screen_text_line1.position.x=(t.game.width-i.pos_screen_text_line1.width)/2,i.pos_screen_text_line2.position.x=(t.game.width-i.pos_screen_text_line2.width)/2,i.pos_screen_text_line3.position.x=(t.game.width-i.pos_screen_text_line3.width)/2,i.pos_screen_text_line1.position.y=(t.game.height-i.pos_screen_text_line1.height)/2,i.pos_screen_text_line2.position.y=i.pos_screen_text_line1.position.y+i.pos_screen_text_line2.height,i.pos_screen_text_line3.position.y=i.pos_screen_text_line2.position.y+i.pos_screen_text_line3.height):(i.pos_screen_text_line1.text="",i.pos_screen_text_line2.text="",i.pos_screen_text_line3.text="",i.pos_screen_text.position.x=(t.game.width-i.pos_screen_text.width)/2);var s=e?MONSTER.Common.trans("Good",t.trans):MONSTER.Common.trans("Wrong",t.trans);i.pos_screen.tint=e?t.colors.success:t.colors.failure,i.pos_screen_comment.text=s,i.pos_screen_comment.position.x=(t.game.width-i.pos_screen_comment.width)/2,i.box.position.x=t.result_screen_x.right,t.game.tweens.push(new MONSTER.Tween(i.box,"position.x",t.result_screen_x.show,1e3)),t.game.setStopFunc(t.next_round,2e3,t)},MONSTER.Easing=function(){},MONSTER.Easing.prototype.constructor=MONSTER.Easing,MONSTER.Easing.linear=function(t){return t},MONSTER.Easing.easeInQuad=function(t){return t*t},MONSTER.Easing.easeOutQuad=function(t){return t*(2-t)},MONSTER.Easing.easeInOutQuad=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},MONSTER.Easing.easeInCubic=function(t){return t*t*t},MONSTER.Easing.easeOutCubic=function(t){return--t*t*t+1},MONSTER.Easing.easeInOutCubic=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},MONSTER.Easing.easeInQuart=function(t){return t*t*t*t},MONSTER.Easing.easeOutQuart=function(t){return 1- --t*t*t*t},MONSTER.Easing.easeInOutQuart=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},MONSTER.Easing.easeInQuint=function(t){return t*t*t*t*t},MONSTER.Easing.easeOutQuint=function(t){return 1+--t*t*t*t*t},MONSTER.Easing.easeInOutQuint=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},MONSTER.Tween=function(t,e,i,s){this.object=t,this.variable=e,this.targetValue=i,this.time=s,this.currentTime=0,this.startValue=getData(this.object,this.variable),this.active=!0},MONSTER.Tween.prototype.update=function(t){this.currentTime+=t;var e=this.currentTime/this.time,i=MONSTER.Easing.easeOutCubic(e),s=Math.round(i*(this.targetValue-this.startValue))+this.startValue;this.active&&setData(this.object,this.variable,s),this.currentTime>this.time&&(this.active=!1)},MONSTER.FuncTimer=function(t,e){this.func=t,this.time=e,this.currentTime=0,this.active=!0},MONSTER.FuncTimer.prototype.update=function(t){this.active&&(this.currentTime+=t,this.active&&this.currentTime>this.time&&(this.active=!1,this.func()))},MONSTER.Key=function(){},MONSTER.Key._pressed={},MONSTER.Key.P=80,MONSTER.Key.SPACE=32,MONSTER.Key.ENTER=13,MONSTER.Key.LEFT=37,MONSTER.Key.UP=38,MONSTER.Key.RIGHT=39,MONSTER.Key.DOWN=40,MONSTER.Key.isDown=function(t){return MONSTER.Key._pressed[t]},MONSTER.Key.isUp=function(t){return!!MONSTER.Key._pressed[t]&&(delete MONSTER.Key._pressed[t],!0)},MONSTER.Key.onKeydown=function(t){MONSTER.Key._pressed[t.keyCode]=!0},MONSTER.Key.onKeyup=function(t){delete MONSTER.Key._pressed[t.keyCode]},window.addEventListener("keyup",function(t){MONSTER.Key.onKeyup(t)},!1),window.addEventListener("keydown",function(t){MONSTER.Key.onKeydown(t)},!1),MONSTER.Key.blockScrolling=function(){window.addEventListener("keydown",function(t){[MONSTER.Key.SPACE,MONSTER.Key.LEFT,MONSTER.Key.RIGHT,MONSTER.Key.DOWN,MONSTER.Key.UP].indexOf(t.keyCode)>-1&&t.preventDefault()},!1)},MONSTER.DataLoader=function(t,e,i,s,o){this.dataset_id=t,this.email=e,this.max_rounds=i,this.pack={},this.success=!1,this.success_func=s,this.sender=o},MONSTER.DataLoader.prototype.constructor=MONSTER.DataLoader,MONSTER.DataLoader.prototype.loadWordPairs=function(){var t=this;t.success=!1,t.error_code=null,$.ajax({method:"GET",crossDomain:!1,timeout:15e3,url:"/api/local/words/"+this.dataset_id+"/"+this.email,error:function(e,i){t.success=!1,t.error_code=i;var s=MONSTER.Common.trans("Server error, please try again",window.translations)+" ("+i+")";t.sender.top_bar_loading_text.text=s;var o=.5*t.sender.game.width-.5*t.sender.top_bar_loading_text.width;t.sender.top_bar_loading_text.position.x=o;var n=MONSTER.Common.createButton(t.sender,MONSTER.Common.trans("Try again",window.translations),0,0,200,50,300,360,function(){location.href=window.location.href});n.interactive=!0,t.sender.game.view.addChild(n)},success:function(e){t.word_sets=e,t.success=!0,t.success_func.apply(t.sender,[t.sender])}})},MONSTER.AbstractScreen=function(t){this.game=t},MONSTER.AbstractScreen.prototype.constructor=MONSTER.AbstractScreen,MONSTER.AbstractScreen.prototype.update=function(){if(this.game.DEBUG){var t=this.game.debug;t.fps_ticks++,t.fps_timer+=Math.round(1e3/this.game.timeSinceLastFrame),t.fps_timer>=1e3&&(t.fps=Math.round(t.fps_timer/t.fps_ticks),t.fps_timer=0,t.fps_ticks=1),t.fps_text.text=t.fps}},MONSTER.LoadingScreen=function(t){var e=this;this.game=t,this.ID="loader",MONSTER.AbstractScreen.call(this,t),MONSTER.Key.blockScrolling(),this.trans=window.translations,this.colors={background:"0x76D3DE",success:"0x33E46D",failure:"0xFF5039"},this.button_colors={question:"#ffffff",active:"0xC72618",hover:"0xAE0D00",click:"0x940000"},this.sizes=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.white),MONSTER.Common.setUpAjax(),this.data_loader=new MONSTER.DataLoader(this.game.data.dataset_id,this.game.data.email,this.max_rounds,this.start_loading,this),this.result_screen_x={show:0,right:this.game.width,left:-this.game.width},this.result_screen_pos=new PIXI.Rectangle(0,0,this.game.width,this.game.height),this.box=new PIXI.Container,this.pos_screen=new PIXI.Graphics,this.pos_screen.beginFill(16777215,.8),this.pos_screen.drawRect(this.result_screen_x.show,this.result_screen_pos.y,this.result_screen_pos.width,this.result_screen_pos.height),this.pos_screen.endFill(),this.pos_screen_comment=new PIXI.Text("",this.sizes[30]),this.pos_screen_text=new PIXI.Text("Language Monster",this.sizes[36]),this.pos_screen_text.position.y=(this.game.height-this.pos_screen_text.height)/2,this.pos_screen_comment.position.y=(this.game.height-this.pos_screen_comment.height)/4,this.box.addChild(this.pos_screen),this.pos_screen.addChild(this.pos_screen_text),this.pos_screen.addChild(this.pos_screen_comment),this.top_bar=new PIXI.Container,this.top_bar_text=new PIXI.Text(MONSTER.Common.trans("Language Monster",this.trans),this.sizes[36]),this.top_bar_loading_text=new PIXI.Text(MONSTER.Common.trans("Loading, please wait",this.trans),this.sizes[26]),this.loading_bar_pos_x=this.result_screen_x.left,this.loading_bar=new PIXI.Graphics,this.loading_bar.beginFill(this.colors.success,.8),this.loading_bar.drawRect(this.loading_bar_pos_x,this.game.height-30,this.game.width,30),this.loading_bar.endFill(),this.top_bar_text_pos={y:.5*this.game.height-.5*this.top_bar_text.height,x:.5*this.game.width-.5*this.top_bar_text.width},this.top_bar_loading_text_pos={y:.7*this.game.height-.5*this.top_bar_loading_text.height,x:.5*this.game.width-.5*this.top_bar_loading_text.width},this.top_bar_text.position.y=this.top_bar_text_pos.y,this.top_bar_text.position.x=this.top_bar_text_pos.x,this.top_bar_loading_text.position.y=this.top_bar_loading_text_pos.y,this.top_bar_loading_text.position.x=this.top_bar_loading_text_pos.x,this.top_bar.addChild(this.top_bar_text),this.top_bar.addChild(this.top_bar_loading_text),this.top_bar.addChild(this.loading_bar),this.init();var i=window.games.concat(["ui"]);this.loader=MONSTER.Common.getLoader(),console.log("Loading assets: "+i);for(var s=0;s<i.length;s++){var o=t.assets[i[s]];for(var n in o)o.hasOwnProperty(n)&&(console.log("Loading "+n+" "+o[n]),this.loader.add(n,o[n]))}this.loader.on("progress",function(){e.loading_bar_pos_x=Math.round(e.loader.progress/100*e.game.width)}),this.loader.on("complete",function(){console.log("Assets loaded"),e.kick_off()}),this.data_loader.loadWordPairs()},MONSTER.LoadingScreen.prototype=Object.create(MONSTER.AbstractScreen.prototype),MONSTER.LoadingScreen.prototype.constructor=MONSTER.LoadingScreen,MONSTER.LoadingScreen.prototype.update=function(){MONSTER.AbstractScreen.prototype.update.call(this),this.loading_bar.position.x=this.loading_bar_pos_x},MONSTER.LoadingScreen.prototype.start_loading=function(){this.game.word_sets=this.data_loader.word_sets,this.game.next_level(),this.loader.load()},MONSTER.LoadingScreen.prototype.init=function(){this.game.background.clear(),this.game.view.removeChildren(),MONSTER.Common.fillBackground(this,this.colors.background),this.game.view.addChild(this.top_bar)},MONSTER.LoadingScreen.prototype.kick_off=function(){this.game.kick_off()},MONSTER.SimpleGame=function(t){MONSTER.AbstractScreen.call(this,t),this.ID="simple",t.tutorial="modal-tut-simple",this.trans=window.translations,this.colors={background:"0x243757",success:"0x33E46D",failure:"0xFF5039",question:"#ffffff",active:"0xC72618",hover:"0xAE0D00",click:"0x940000"},this.button_colors={question:"#ffffff",active:"0xC72618",hover:"0xAE0D00",click:"0x940000"},this.sizes=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.white),MONSTER.Common.setUpAjax(),this.result_screen_x={show:0,right:this.game.width,left:-this.game.width},this.result_screen_pos=new PIXI.Rectangle(0,0,this.game.width,this.game.height),this.box=MONSTER.GoodWrongScreen(this.game,this.result_screen_x,this.result_screen_pos),this.init()},MONSTER.SimpleGame.prototype=Object.create(MONSTER.AbstractScreen.prototype),MONSTER.SimpleGame.prototype.constructor=MONSTER.SimpleGame,MONSTER.SimpleGame.prototype.onGamePause=function(){},MONSTER.SimpleGame.prototype.onGamePauseOff=function(){},MONSTER.SimpleGame.prototype.update=function(){MONSTER.AbstractScreen.prototype.update.call(this)},MONSTER.SimpleGame.prototype.next_round=function(){var t=this;setTimeout(function(){t.init()},100),this.game.tweens.push(new MONSTER.Tween(this.box.box,"position.x",this.result_screen_x.left,1e3))},MONSTER.SimpleGame.prototype.resultScreen=function(t){MONSTER.GoodWrongScreen.prepare(this,t)},MONSTER.SimpleGame.prototype.check_answer=function(t){t===this.answer?MONSTER.Common.correct(this):MONSTER.Common.negative(this)},MONSTER.SimpleGame.prototype.init=function(){var t=this;if(this.game.background.clear(),this.game.view.removeChildren(),MONSTER.Common.fillBackground(this,this.colors.background),!MONSTER.Common.getWordSet(this))return MONSTER.Common.endScreen(this);var e=new PIXI.Text(this.question,{font:"36px Montserrat",fill:this.colors.question});e.position.x=(this.game.width-e.width)/2,e.position.y=.12*this.game.height,this.game.view.addChild(e);var i=250,s=90,o=1400,n=MONSTER.Common.createButton(this,this.choices[0],0,0,i,s,-i,150,function(){n.interactive=!1,t.check_answer(t.choices[0])});n.interactive=!0;var h=MONSTER.Common.createButton(this,this.choices[1],0,0,i,s,this.game.width+i,150,function(){h.interactive=!1,t.check_answer(t.choices[1])});h.interactive=!0;var a=MONSTER.Common.createButton(this,this.choices[2],0,0,i,s,-i,280,function(){a.interactive=!1,t.check_answer(t.choices[2])});a.interactive=!0;var r=MONSTER.Common.createButton(this,this.choices[3],0,0,i,s,this.game.width+i,280,function(){r.interactive=!1,t.check_answer(t.choices[3])});r.interactive=!0,this.game.view.addChild(n),this.game.view.addChild(h),this.game.view.addChild(a),this.game.view.addChild(r),this.game.tweens.push(new MONSTER.Tween(n,"position.x",75,o)),this.game.tweens.push(new MONSTER.Tween(h,"position.x",475,o)),this.game.tweens.push(new MONSTER.Tween(a,"position.x",75,o)),this.game.tweens.push(new MONSTER.Tween(r,"position.x",475,o)),MONSTER.Common.addUI(this.game),this.box.box.position.x=this.result_screen_x.right,this.game.view.addChild(this.box.box),setTimeout(function(){MONSTER.Common.showTutorial(this.game)},700)},MONSTER.SpaceGame=function(t){this.ID="space",t.tutorial="modal-tut-space",MONSTER.AbstractScreen.call(this,t),MONSTER.Key.blockScrolling(),this.trans=window.translations,this.colors={background:"0x7FBFFF",success:"0x33E46D",failure:"0xFF5039"},this.button_colors={question:"#ffffff",active:"0xC72618",hover:"0xAE0D00",click:"0x940000"},this.hit=!1,this.shipActive=!0,this.sizes=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.navy),this.rects=[new PIXI.Rectangle(70,125,200,100),new PIXI.Rectangle(450,125,200,100),new PIXI.Rectangle(70,300,200,100),new PIXI.Rectangle(450,300,200,100)],this.answers=[],MONSTER.Common.setUpAjax(),this.result_screen_on=!1,this.result_screen_x={show:0,right:this.game.width,left:-this.game.width},this.result_screen_pos=new PIXI.Rectangle(0,0,this.game.width,this.game.height),this.box=MONSTER.GoodWrongScreen(this.game,this.result_screen_x,this.result_screen_pos),this.top_bar=new PIXI.Container,this.top_bar_text=new PIXI.Text("",this.sizes[36]),this.top_bar_y={show:.18*this.game.height,hide:-this.top_bar_text.height},this.top_bar_text.position.y=this.top_bar_y.hide,this.top_bar.addChild(this.top_bar_text),this.urls=this.game.assets.space,this.time_to_reenable=0,this.ship_v=0,this.max_v=4.8,this.min_v=.8,this.drag=.0015,this.rotation_v=.0028,this.brakes=.001,this.acceleration=.003,this.assets=MONSTER.Utils.objectValues(this.urls),this.init()},MONSTER.SpaceGame.prototype=Object.create(MONSTER.AbstractScreen.prototype),MONSTER.SpaceGame.prototype.constructor=MONSTER.SpaceGame,MONSTER.SpaceGame.prototype.onGamePause=function(){},MONSTER.SpaceGame.prototype.onGamePauseOff=function(){},MONSTER.SpaceGame.prototype.update=function(){if(MONSTER.AbstractScreen.prototype.update.call(this),!this.hit){var t=this.game.timeSinceLastFrame;this.moveShip();var e=this.island.position.x+5e-4*t*-this.diff_x,i=this.island.position.y+5e-4*t*-this.diff_y;this.island.position.x=MONSTER.Utils.clamp(e,-25,25),this.island.position.y=MONSTER.Utils.clamp(i,-25,25),MONSTER.Common.parallax(t,this.parallax,this.parallax_speed,800),this.shipActive?this.checkCollisions():(this.time_to_reenable-=t,this.time_to_reenable<=0&&this.enableShip())}},MONSTER.SpaceGame.prototype.init=function(){var t=78,e=6;this.game.background.clear(),this.game.view.removeChildren(),MONSTER.Common.fillBackground(this,"0x2d98a9");var i=PIXI.Texture.fromImage(this.urls.space_ocean),s=PIXI.Texture.fromImage(this.urls.space_clouds),o=[new PIXI.Sprite(i),new PIXI.Sprite(i)],n=[new PIXI.Sprite(s),new PIXI.Sprite(s)];this.parallax=[n],this.parallax_speed=[.005,.02,.02,.04],this.game.background.addChild(o[0]),this.game.background.addChild(o[1]),o[1].position.x=800,this.island=o[0],this.game.background.addChild(n[0]),this.game.background.addChild(n[1]),n[1].position.x=800;for(var h=PIXI.BaseTexture.fromImage(this.urls.space_plane),a=PIXI.BaseTexture.fromImage(this.urls.space_plane_left),r=PIXI.BaseTexture.fromImage(this.urls.space_plane_right),p=[],c=[],m=[],d=0;d<e;d++){var l=new PIXI.Rectangle(d*t,0,t,t);p.push(new PIXI.Texture(h,l)),c.push(new PIXI.Texture(a,l)),m.push(new PIXI.Texture(r,l))}this.ship_normal=this.createShip(p),this.ship_left=this.createShip(c),this.ship_right=this.createShip(m),this.game.view.addChild(this.ship_normal),this.game.view.addChild(this.ship_left),this.game.view.addChild(this.ship_right),this.ship=this.ship_normal,this.ship.play(),this.ship.position.x=this.game.width,this.ship.position.y=this.ship.height,this.ship_v=(this.max_v-this.min_v)/2,this.ship.rotation=1.5*Math.PI,this.game.view.addChild(this.top_bar),this.box.box.position.x=this.result_screen_x.right,MONSTER.Common.addUI(this.game),this.game.view.addChild(this.box.box),setTimeout(function(){MONSTER.Common.showTutorial(this.game)},700),this.next_round()},MONSTER.SpaceGame.prototype.createShip=function(t){var e=new PIXI.extras.MovieClip(t);return e.animationSpeed=.5,e.anchor.x=e.anchor.y=.5,e.position.x=-1e3,e},MONSTER.SpaceGame.prototype.moveShip=function(){var t=this.game.timeSinceLastFrame;if(MONSTER.Key&&MONSTER.Key.isDown(MONSTER.Key.LEFT)?(this.ship.rotation-=t*this.rotation_v,this.turn(MONSTER.Const.LEFT)):MONSTER.Key&&MONSTER.Key.isDown(MONSTER.Key.RIGHT)?(this.ship.rotation+=t*this.rotation_v,this.turn(MONSTER.Const.RIGHT)):this.turn(MONSTER.Const.AHEAD),MONSTER.Key&&MONSTER.Key.isDown(MONSTER.Key.UP)?this.ship_v+=t*this.acceleration+1/(this.max_v*this.max_v):MONSTER.Key&&MONSTER.Key.isDown(MONSTER.Key.DOWN)&&(this.ship_v-=t*this.brakes),this.ship){var e=this.ship.position.x,i=this.ship.position.y,s=this.ship.rotation;this.ship.position.x+=this.ship_v*Math.cos(s-MONSTER.Const.PI_2),this.ship.position.y+=this.ship_v*Math.sin(s-MONSTER.Const.PI_2),this.diff_x=this.ship.position.x-e,this.diff_y=this.ship.position.y-i,this.ship_v-=this.drag*t,this.ship_v<this.min_v&&(this.ship_v=this.min_v),this.ship_v>this.max_v&&(this.ship_v=this.max_v),this.ship.position.x>this.game.width?this.ship.position.x=this.game.width-this.ship.position.x:this.ship.position.x<0&&(this.ship.position.x=this.game.width-this.ship.position.x),this.ship.position.y>this.game.height?this.ship.position.y=this.game.height-this.ship.position.y:this.ship.position.y<0&&(this.ship.position.y=this.game.height-this.ship.position.y)}},MONSTER.SpaceGame.prototype.turn=function(t){var e=null,i=[];t===MONSTER.Const.LEFT?(e=this.ship_left,i.push(this.ship_normal),i.push(this.ship_right)):t===MONSTER.Const.RIGHT?(e=this.ship_right,i.push(this.ship_normal),i.push(this.ship_left)):(e=this.ship_normal,i.push(this.ship_right),i.push(this.ship_left)),e.position.x=this.ship.position.x,e.position.y=this.ship.position.y,e.rotation=this.ship.rotation,e.play();for(var s=0;s<2;s++)i[s].stop(),i[s].position.x=-1e3;this.ship=e},MONSTER.SpaceGame.prototype.checkCollisions=function(){if(this.ship&&this.ship_v>0&&!this.hit)for(var t=0;t<this.answers.length;t++){var e=this.answers[t];e.r.contains(this.ship.position.x,this.ship.position.y)&&(this.hit=!0,this.shipActive=!1,this.ship_normal.alpha=this.ship_left.alpha=this.ship_right.alpha=.5,this.moveOutOfScreen(),e.word==this.answer?MONSTER.Common.correct(this):MONSTER.Common.negative(this))}},MONSTER.SpaceGame.prototype.enableShip=function(){this.shipActive=!0,this.ship_normal.alpha=this.ship_left.alpha=this.ship_right.alpha=1},MONSTER.SpaceGame.prototype.disableShip=function(){this.shipActive=!1,this.ship_normal.alpha=this.ship_left.alpha=this.ship_right.alpha=.5},MONSTER.SpaceGame.prototype.moveOutOfScreen=function(){this.game.tweens.push(new MONSTER.Tween(this.top_bar,"position.y",this.top_bar_y.hide,1e3));for(var t=0;t<this.answers.length;t++){var e=this.answers[t];e.text.position.x<this.game.width/2?this.game.tweens.push(new MONSTER.Tween(e.text,"position.x",-e.text.width/2,1e3)):this.game.tweens.push(new MONSTER.Tween(e.text,"position.x",this.game.width+e.text.width/2,1e3))}},MONSTER.SpaceGame.prototype.resultScreen=function(t){MONSTER.GoodWrongScreen.prepare(this,t)},MONSTER.SpaceGame.prototype.next_round=function(){return this.answers.length=0,this.game.tweens.length=0,MONSTER.Common.getWordSet(this)?(this.top_bar_text.text=this.question,this.top_bar_text.position.x=(this.game.width-this.top_bar_text.width)/2,this.hit&&(this.game.tweens.push(new MONSTER.Tween(this.box.box,"position.x",this.result_screen_x.left,1e3)),this.time_to_reenable=1500),this.game.tweens.push(new MONSTER.Tween(this.top_bar,"position.y",this.top_bar_y.show,1e3)),this.createAnswer(this.choices[0],0),this.createAnswer(this.choices[1],1),this.createAnswer(this.choices[2],2),this.createAnswer(this.choices[3],3),void(this.hit=!1)):MONSTER.Common.endScreen(this)},MONSTER.SpaceGame.prototype.createAnswer=function(t,e){var i=this,s=this.rects[e],o=Math.floor(Math.random()*s.width+s.x),n=Math.floor(Math.random()*s.height+s.y),h=[this.sizes[22],this.sizes[16],this.sizes[12]],a=0,r=new PIXI.Text(t,h[a]);MONSTER.Common.secure_answer_size(r,h,150);var p=function(){o<i.game.width/2?r.position.x=-r.width:r.position.x=i.game.width+r.width,r.position.y=n,r.anchor.x=r.anchor.y=.5,i.game.background.addChild(r);var e=new PIXI.Rectangle(o-r.width/2,r.position.y-r.height/2,r.width,r.height),s={r:e,word:t,text:r};i.answers.push(s),i.game.tweens.push(new MONSTER.Tween(r,"position.x",o,1e3))};p()},MONSTER.PlaneGame=function(t){this.ID="plane",t.tutorial="modal-tut-plane",MONSTER.AbstractScreen.call(this,t),MONSTER.Key.blockScrolling(),this.trans=window.translations,this.colors={background:"0x76D3DE",success:"0x33E46D",failure:"0xFF5039"},this.button_colors={question:"#ffffff",active:"0xC72618",hover:"0xAE0D00",click:"0x940000"},this.hit=!1,this.constant_answer_speed=!1,this.sizes=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.navy),this.rects=[new PIXI.Rectangle(70,125,200,100),new PIXI.Rectangle(450,125,200,100),new PIXI.Rectangle(70,300,200,100),new PIXI.Rectangle(450,300,200,100)],this.answers=[],MONSTER.Common.setUpAjax(),this.result_screen_on=!1,this.result_screen_x={show:0,right:this.game.width,left:-this.game.width},this.result_screen_pos=new PIXI.Rectangle(0,0,this.game.width,this.game.height),this.box=MONSTER.GoodWrongScreen(this.game,this.result_screen_x,this.result_screen_pos),this.top_bar=new PIXI.Container,this.top_bar_text=new PIXI.Text("",this.sizes[36]),this.top_bar_y={show:.18*this.game.height,hide:-this.top_bar_text.height},this.top_bar_text.position.y=this.top_bar_y.hide,this.top_bar.addChild(this.top_bar_text),this.urls=this.game.assets.plane,this.ship_v=0,this.max_v=6,this.drag=.0015,this.rotation_v=.0028,this.brakes=.001,this.acceleration=.003,this.assets=MONSTER.Utils.objectValues(this.urls),this.init()},MONSTER.PlaneGame.prototype=Object.create(MONSTER.AbstractScreen.prototype),MONSTER.PlaneGame.prototype.constructor=MONSTER.PlaneGame,MONSTER.PlaneGame.prototype.onGamePause=function(){},MONSTER.PlaneGame.prototype.onGamePauseOff=function(){},MONSTER.PlaneGame.prototype.update=function(){if(MONSTER.AbstractScreen.prototype.update.call(this),!this.hit){var t=this.game.timeSinceLastFrame;if(this.moveShip(),MONSTER.Common.parallax(t,this.parallax,this.parallax_speed,800),
this.answers&&this.game.actual_rounds)for(var e=0;e<this.answers.length;e++)this.constant_answer_speed?this.answers[e].text.position.x-=.14*t:this.answers[e].text.position.x-=MONSTER.linear(this.game.round_id,0,this.game.actual_rounds-1,.08,.1)*t;this.checkCollisions()}},MONSTER.PlaneGame.prototype.init=function(){this.game.background.clear(),this.game.view.removeChildren();var t=PIXI.Texture.fromImage(this.urls.plane_sky),e=PIXI.Texture.fromImage(this.urls.plane_background),i=PIXI.Texture.fromImage(this.urls.plane_valley),s=PIXI.Texture.fromImage(this.urls.plane_hills),o=[new PIXI.Sprite(t)],n=[new PIXI.Sprite(e),new PIXI.Sprite(e)],h=[new PIXI.Sprite(i),new PIXI.Sprite(i)],a=[new PIXI.Sprite(s),new PIXI.Sprite(s)];this.parallax=[n,h,a],this.parallax_speed=[.01,.03,.05],this.game.background.addChild(o[0]),this.game.background.addChild(n[0]),this.game.background.addChild(n[1]),this.game.background.addChild(h[0]),this.game.background.addChild(h[1]),this.game.background.addChild(a[0]),this.game.background.addChild(a[1]),n[1].position.x=800,n[0].position.y=190,n[1].position.y=190,h[1].position.x=800,h[0].position.y=270,h[1].position.y=270,a[1].position.x=800,a[0].position.y=199,a[1].position.y=199;for(var r=[],p=PIXI.BaseTexture.fromImage(this.urls.plane_plane),c=5,m=100,d=60,l=0;l<c;l++){var u=new PIXI.Rectangle(l*m,0,m,d);r.push(new PIXI.Texture(p,u))}this.ship=new PIXI.extras.MovieClip(r),this.ship.animationSpeed=.5,this.ship.play(),this.game.view.addChild(this.ship),this.ship.anchor.x=.5,this.ship.anchor.y=.5;var g=.25*this.game.height,_=.83*this.game.height;this.ship.position.x=.2*this.game.width,this.ship.position.y=g,this.ship.start_y=g,this.ship.stop_y=_,this.ship.v_time=0,this.ship.v_up=!1,this.ship.v_up_tmp=0,this.game.view.addChild(this.top_bar),this.box.box.position.x=this.result_screen_x.right,MONSTER.Common.addUI(this.game),this.game.view.addChild(this.box.box),setTimeout(function(){MONSTER.Common.showTutorial(this.game)},700),this.next_round()},MONSTER.PlaneGame.prototype.moveShip=function(){var t=this.game.timeSinceLastFrame,e=0,i=!1;MONSTER.Key.isDown(MONSTER.Key.UP)&&(i=!0,e=MONSTER.Utils.to_radians(-10));var s=Math.round(.14*this.game.height);if(this.ship.position.y<=s&&i)return this.ship.position.y=s,void(this.ship.rotation=0);if(this.ship.rotation=e,this.ship.v_up=i,this.ship)if(this.ship.v_up){this.ship.start_y=this.ship.position.y,this.ship.v_time=0;var o=.11*t;this.ship.position.y-=o}else{var n=2e3;this.ship.v_time+=t,this.ship.rotation=0;var h=MONSTER.Easing.easeInOutQuart(this.ship.v_time/n);this.ship.position.y=Math.round(h*(this.ship.stop_y-this.ship.start_y))+this.ship.start_y,this.ship.v_time>n&&(this.ship.position.y=this.ship.stop_y)}},MONSTER.PlaneGame.prototype.checkCollisions=function(){if(this.ship&&!this.hit){for(var t=0,e=0;e<this.answers.length;e++){var i=this.answers[e];Math.abs(i.text.position.x-this.ship.position.x)<this.ship.width/2&&Math.abs(i.text.position.y-this.ship.position.y)<this.ship.height/2?(this.hit=!0,this.moveOutOfScreen(),i.word==this.answer?MONSTER.Common.correct(this):MONSTER.Common.negative(this)):i.text.position.x<i.text.width/2&&t++}t==this.answers.length&&(this.constant_answer_speed=!0,this.hit=!0,this.moveOutOfScreen(),MONSTER.Common.negative(this))}},MONSTER.PlaneGame.prototype.moveOutOfScreen=function(){this.game.tweens.push(new MONSTER.Tween(this.top_bar,"position.y",this.top_bar_y.hide,1e3));for(var t=0;t<this.answers.length;t++){var e=this.answers[t];e.text.position.x<this.game.width/2?this.game.tweens.push(new MONSTER.Tween(e.text,"position.x",-e.text.width/2,1e3)):this.game.tweens.push(new MONSTER.Tween(e.text,"position.x",this.game.width+e.text.width/2,1e3))}},MONSTER.PlaneGame.prototype.resultScreen=function(t){MONSTER.GoodWrongScreen.prepare(this,t)},MONSTER.PlaneGame.prototype.next_round=function(){return this.answers.length=0,this.game.tweens.length=0,MONSTER.Common.getWordSet(this)?(this.top_bar_text.text=this.question,this.top_bar_text.position.x=(this.game.width-this.top_bar_text.width)/2,this.hit&&this.game.tweens.push(new MONSTER.Tween(this.box.box,"position.x",this.result_screen_x.left,1e3)),this.game.tweens.push(new MONSTER.Tween(this.top_bar,"position.y",this.top_bar_y.show,1e3)),this.createAnswer(this.choices[0],0),this.createAnswer(this.choices[1],1),this.createAnswer(this.choices[2],2),this.createAnswer(this.choices[3],3),void(this.hit=!1)):MONSTER.Common.endScreen(this)},MONSTER.PlaneGame.prototype.createAnswer=function(t,e){var i=this,s=this.rects[e],o=[this.sizes[22],this.sizes[16],this.sizes[12]],n=0,h=new PIXI.Text(t,o[n]);MONSTER.Common.secure_answer_size(h,o,150);var a=function(){h.position.x=.7*Math.floor(Math.random()*s.width+s.x)+.7*this.game.width,h.position.y=Math.floor(Math.random()*s.height+s.y),h.anchor.x=h.anchor.y=.5,i.game.background.addChild(h);var e={word:t,text:h};i.answers.push(e)};a()},MONSTER.RunnerGame=function(t){this.ID="runner",t.tutorial="modal-tut-runner",MONSTER.AbstractScreen.call(this,t),MONSTER.Key.blockScrolling(),this.trans=window.translations,this.colors={background:"0x76D3DE",success:"0x33E46D",failure:"0xFF5039"},this.button_colors={question:"#ffffff",active:"0xC72618",hover:"0xAE0D00",click:"0x940000"},this.hit=!1,this.shipActive=!0,this.constant_answer_speed=!1,this.sizes=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.white),this.rects=[new PIXI.Rectangle(0,240,100,100),new PIXI.Rectangle(500,240,100,100),new PIXI.Rectangle(1e3,240,100,100),new PIXI.Rectangle(1500,240,100,100)],this.answers=[],MONSTER.Common.setUpAjax(),this.result_screen_on=!1,this.result_screen_x={show:0,right:this.game.width,left:-this.game.width},this.result_screen_pos=new PIXI.Rectangle(0,0,this.game.width,this.game.height),this.box=MONSTER.GoodWrongScreen(this.game,this.result_screen_x,this.result_screen_pos),this.top_bar=new PIXI.Container,this.top_bar_text=new PIXI.Text("",this.sizes[36]),this.top_bar_y={show:.18*this.game.height,hide:-this.top_bar_text.height},this.top_bar_text.position.y=this.top_bar_y.hide,this.top_bar.addChild(this.top_bar_text),this.urls=this.game.assets.runner,this.ship_v=0,this.max_v=6,this.drag=.0015,this.rotation_v=.0028,this.brakes=.001,this.acceleration=.003,this.State={RUNNING:0,JUMPING:1,FALLING:2,SLIDING:3},this.state=this.State.RUNNING,this.JUMP_TIME=600,this.assets=MONSTER.Utils.objectValues(this.urls),this.init()},MONSTER.RunnerGame.prototype=Object.create(MONSTER.AbstractScreen.prototype),MONSTER.RunnerGame.prototype.constructor=MONSTER.RunnerGame,MONSTER.RunnerGame.prototype.update=function(){MONSTER.AbstractScreen.prototype.update.call(this);var t=this.game.timeSinceLastFrame;if(!this.hit){if(MONSTER.Common.parallax(t,this.parallax,this.parallax_speed,800),this.moveShip(),this.answers&&this.game.actual_rounds)for(var e=0;e<this.answers.length;e++)this.answers[e].text.position.x-=MONSTER.linear(this.game.round_id,0,this.game.actual_rounds-1,.2,.23)*t;this.shipActive&&this.checkCollisions()}},MONSTER.RunnerGame.prototype.onGamePause=function(){this.ship.gotoAndStop(1)},MONSTER.RunnerGame.prototype.onGamePauseOff=function(){this.ship.play()},MONSTER.RunnerGame.prototype.init=function(){this.game.background.clear(),this.game.view.removeChildren();var t=PIXI.Texture.fromImage(this.urls.runner_far_background),e=PIXI.Texture.fromImage(this.urls.runner_background),i=PIXI.Texture.fromImage(this.urls.runner_trees),s=PIXI.Texture.fromImage(this.urls.runner_foreground),o=PIXI.Texture.fromImage(this.urls.runner_ground),n=[new PIXI.Sprite(t),new PIXI.Sprite(t)],h=[new PIXI.Sprite(e),new PIXI.Sprite(e)],a=[new PIXI.Sprite(i),new PIXI.Sprite(i)],r=[new PIXI.Sprite(s),new PIXI.Sprite(s)],p=[new PIXI.Sprite(o),new PIXI.Sprite(o)];this.parallax=[n,h,a,p,r],this.parallax_speed=[.01,.03,.05,.07,.1],n[0].position.x=0,n[1].position.x=800,h[0].position.x=0,h[1].position.x=800,a[0].position.x=0,a[1].position.x=800,p[0].position.x=0,p[0].position.y=386,p[1].position.x=800,p[1].position.y=386,r[0].position.x=0,r[0].position.y=255,r[1].position.x=800,r[1].position.y=255,this.game.background.addChild(n[0]),this.game.background.addChild(n[1]),this.game.background.addChild(h[0]),this.game.background.addChild(h[1]),this.game.background.addChild(a[0]),this.game.background.addChild(a[1]),this.textures=[],this.textures_jump=[];for(var c=88,m=150,d=158,l=8,u=PIXI.BaseTexture.fromImage(this.urls.runner_run),g=PIXI.BaseTexture.fromImage(this.urls.runner_jump),_=0;_<l;_++){var S=new PIXI.Rectangle(_*c,0,c,m);if(this.textures.push(new PIXI.Texture(u,S)),_>0){var w=new PIXI.Rectangle(_*c,0,c,d);this.textures_jump.push(new PIXI.Texture(g,w))}}this.ship=new PIXI.extras.MovieClip(this.textures),this.ship.animationSpeed=.2,this.ship.play(),this.ship.anchor.x=.5,this.ship.anchor.y=.5;var T=.56*this.game.height,x=.71*this.game.height;this.original_y=.71*this.game.height,this.slide_y=.82*this.game.height,this.ship.position.x=.2*this.game.width,this.ship.position.y=x,this.ship.start_y=x,this.ship.stop_y=T,this.ship.v_time=0,this.ship.v_up=!1,this.ship.v_down=!1,this.game.view.addChild(this.top_bar),this.box.box.position.x=this.result_screen_x.right,this.game.view.addChild(p[0]),this.game.view.addChild(p[1]),this.game.view.addChild(this.ship),this.game.view.addChild(r[0]),this.game.view.addChild(r[1]),MONSTER.Common.addUI(this.game),this.game.view.addChild(this.box.box),console.log("before set"),console.log("after set"),this.next_round()},MONSTER.RunnerGame.prototype.moveShip=function(){var t=this.game.timeSinceLastFrame;if(this.state===this.State.RUNNING&&MONSTER.Key.isUp(MONSTER.Key.UP)&&(this.state=this.State.JUMPING,this.ship.textures=this.textures_jump,this.ship.start_y=this.ship.position.y,this.ship.stop_y=this.ship.start_y-200),this.state===this.State.RUNNING&&MONSTER.Key.isDown(MONSTER.Key.DOWN)&&(this.state=this.State.SLIDING,this.ship.rotation=1.5*MONSTER.Const.PI,this.ship.gotoAndStop(1),this.ship.position.y=this.slide_y),this.state===this.State.SLIDING)MONSTER.Key.isDown(MONSTER.Key.DOWN)||(this.state=this.State.RUNNING,this.ship.rotation=0,this.ship.play(),this.ship.position.y=this.original_y);else if(this.state===this.State.JUMPING){this.ship.v_time+=t;var e=MONSTER.Easing.easeOutQuart(this.ship.v_time/this.JUMP_TIME);this.ship.position.y=Math.round(e*(this.ship.stop_y-this.ship.start_y))+this.ship.start_y,this.ship.v_time>this.JUMP_TIME&&(this.ship.v_time=0,this.state=this.State.FALLING,this.ship.position.y=this.ship.stop_y)}this.state===this.State.FALLING&&this.ship.position.y<this.original_y&&(this.ship.position.y+=.3*t),this.state===this.State.FALLING&&this.ship.position.y>=this.original_y&&(this.state=this.State.RUNNING,this.ship.textures=this.textures)},MONSTER.RunnerGame.prototype.checkCollisions=function(){if(this.ship&&!this.hit){for(var t=0,e=0;e<this.answers.length;e++){var i=this.answers[e],s=!1;this.ship.v_down?i.text.position.x>=this.ship.position.x-this.ship.width/2&&i.text.position.x<=this.ship.position.x+this.ship.width/2&&i.text.position.y>=this.ship.position.y-this.ship.height/2.5&&i.text.position.y<=this.ship.position.y+this.ship.height/2.5&&(s=!0):i.text.position.x>=this.ship.position.x-this.ship.width/2&&i.text.position.x<=this.ship.position.x+this.ship.width/2&&i.text.position.y>=this.ship.position.y-this.ship.height/2&&i.text.position.y<=this.ship.position.y+this.ship.height/2&&(s=!0),s?(this.hit=!0,this.moveOutOfScreen(),i.word==this.answer?MONSTER.Common.correct(this):MONSTER.Common.negative(this)):i.text.position.x<i.text.width/2&&t++}t===this.answers.length&&this.state===this.State.RUNNING&&(this.constant_answer_speed=!0,this.hit=!0,this.moveOutOfScreen(),MONSTER.Common.negative(this))}},MONSTER.RunnerGame.prototype.moveOutOfScreen=function(){this.game.tweens.push(new MONSTER.Tween(this.top_bar,"position.y",this.top_bar_y.hide,1e3));for(var t=0;t<this.answers.length;t++){var e=this.answers[t];e.text.position.x<this.game.width/2?this.game.tweens.push(new MONSTER.Tween(e.text,"position.x",-e.text.width/2,1e3)):this.game.tweens.push(new MONSTER.Tween(e.text,"position.x",this.game.width+e.text.width/2,1e3))}},MONSTER.RunnerGame.prototype.resultScreen=function(t){this.ship.stop(),MONSTER.GoodWrongScreen.prepare(this,t)},MONSTER.RunnerGame.prototype.next_round=function(){return this.answers.length=0,this.game.tweens.length=0,MONSTER.Common.getWordSet(this)?(this.ship.play(),this.top_bar_text.text=this.question,this.top_bar_text.position.x=(this.game.width-this.top_bar_text.width)/2,this.hit&&(this.game.tweens.push(new MONSTER.Tween(this.box.box,"position.x",this.result_screen_x.left,1e3)),this.game.setStopFunc(this.activateShipAgain,1500,this)),this.game.tweens.push(new MONSTER.Tween(this.top_bar,"position.y",this.top_bar_y.show,1e3)),this.createAnswer(this.choices[0],0),this.createAnswer(this.choices[1],1),this.createAnswer(this.choices[2],2),this.createAnswer(this.choices[3],3),void(this.hit=!1)):MONSTER.Common.endScreen(this)},MONSTER.RunnerGame.prototype.activateShipAgain=function(){this.shipActive=!0},MONSTER.RunnerGame.prototype.createAnswer=function(t,e){var i=this,s=this.rects[e],o=[this.sizes[22],this.sizes[16],this.sizes[12]],n=0,h=new PIXI.Text(t,o[n]);h.style=o[n];var a=150;MONSTER.Common.secure_answer_size(h,o,a);var r=function(){h.position.x=1*Math.floor(Math.random()*s.width+s.x)+1*this.game.width,h.position.y=Math.floor(Math.random()*s.height+s.y),h.anchor.x=h.anchor.y=.5,i.game.background.addChild(h);var e={word:t,text:h};i.answers.push(e)};r()},MONSTER.ShooterGame=function(t){this.ID="shooter",t.tutorial="modal-tut-shooter",MONSTER.AbstractScreen.call(this,t),MONSTER.Key.blockScrolling(),this.trans=window.translations,this.colors={background:"0x76D3DE",success:"0x33E46D",failure:"0xFF5039"},this.button_colors={question:"#ffffff",active:"0xC72618",hover:"0xAE0D00",click:"0x940000"},this.SNOWBALL_TIME=700,this.hit=!1,this.shipActive=!0,this.constant_answer_speed=!1,this.sizes=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.navy),this.rects=[new PIXI.Rectangle(0,130,100,90),new PIXI.Rectangle(300,130,100,90),new PIXI.Rectangle(600,130,100,90),new PIXI.Rectangle(900,130,100,90)],this.answers=[],MONSTER.Common.setUpAjax(),this.result_screen_on=!1,this.result_screen_x={show:0,right:this.game.width,left:-this.game.width},this.result_screen_pos=new PIXI.Rectangle(0,0,this.game.width,this.game.height),this.box=MONSTER.GoodWrongScreen(this.game,this.result_screen_x,this.result_screen_pos),this.top_bar=new PIXI.Container,this.top_bar_text=new PIXI.Text("",this.sizes[36]),this.top_bar_y={show:.18*this.game.height,hide:-this.top_bar_text.height},this.top_bar_text.position.y=this.top_bar_y.hide,this.top_bar.addChild(this.top_bar_text),this.urls=this.game.assets.shooter,this.ship_v=0,this.max_v=6,this.drag=.0015,this.rotation_v=.0028,this.brakes=.001,this.acceleration=.003,this.assets=MONSTER.Utils.objectValues(this.urls),this.init()},MONSTER.ShooterGame.prototype=Object.create(MONSTER.AbstractScreen.prototype),MONSTER.ShooterGame.prototype.constructor=MONSTER.ShooterGame,MONSTER.ShooterGame.prototype.update=function(){if(MONSTER.AbstractScreen.prototype.update.call(this),!this.hit){this.move();var t=this.game.timeSinceLastFrame;if(MONSTER.Common.parallax(t,this.parallax,this.parallax_speed,800),this.answers&&this.game.actual_rounds){for(var e=0,i=0;i<this.answers.length;i++)this.constant_answer_speed?this.answers[i].text.position.x-=.16*t:this.answers[i].text.position.x-=MONSTER.linear(this.game.round_id,0,this.game.actual_rounds-1,.16,.19)*t,this.answers[i].text.position.x+this.answers[i].text.width<0&&e++;e==this.answers.length&&(this.constant_answer_speed=!0,this.hit=!0,this.removeAnswers(this.answers),MONSTER.Common.negative(this))}}},MONSTER.ShooterGame.prototype.onGamePause=function(){},MONSTER.ShooterGame.prototype.onGamePauseOff=function(){MONSTER.Common.hideCursor()},MONSTER.ShooterGame.prototype.mousemove=function(t){this.crosshair.position.x=t.data.global.x,this.crosshair.position.y=t.data.global.y},MONSTER.ShooterGame.prototype.init=function(){this.game.background.clear(),this.game.view.removeChildren(),MONSTER.Common.hideCursor();var t=PIXI.Texture.fromImage(this.urls.shooter_background),e=PIXI.Texture.fromImage(this.urls.shooter_clouds),i=PIXI.Texture.fromImage(this.urls.shooter_middle),s=PIXI.Texture.fromImage(this.urls.shooter_foreground),o=[new PIXI.Sprite(t),new PIXI.Sprite(t)],n=[new PIXI.Sprite(e),new PIXI.Sprite(e)],h=[new PIXI.Sprite(i),new PIXI.Sprite(i)],a=[new PIXI.Sprite(s),new PIXI.Sprite(s)];this.parallax=[n,o,h,a],this.parallax_speed=[.01,.02,.02,.04],this.game.background.addChild(o[0]),this.game.background.addChild(o[1]),this.game.background.addChild(n[0]),this.game.background.addChild(n[1]),this.game.background.addChild(h[0]),this.game.background.addChild(h[1]),this.game.background.addChild(a[0]),this.game.background.addChild(a[1]),o[0].position.y=-34,o[1].position.y=-34,o[1].position.x=800,n[1].position.x=800,h[1].position.x=800,h[0].position.y=220,h[1].position.y=220,a[1].position.x=800,a[0].position.y=130,a[1].position.y=130,this.crosshair_t=PIXI.Texture.fromImage(this.urls.shooter_crosshair);var r=PIXI.Texture.fromImage(this.urls.shooter_snowball);this.snowball={sprite:new PIXI.Sprite(r),src:[0,0],dest:[0,0],time:0,thrown:!1,pos:[0,0]},this.crosshair=new PIXI.Sprite(this.crosshair_t),this.crosshair.anchor.x=this.crosshair.anchor.y=.5,this.crosshair.position.x=.5*this.game.width,this.crosshair.position.y=.5*this.game.height,this.game.view.interactive=!0,this.game.view.on("mousemove",this.mousemove.bind(this)),this.game.view.on("click",this["throw"].bind(this)),this.game.view.addChild(this.top_bar),this.box.box.position.x=this.result_screen_x.right,this.game.view.addChild(this.crosshair),this.game.view.addChild(this.snowball.sprite),this.resetSnowball(this.snowball),MONSTER.Common.addUI(this.game),this.game.view.addChild(this.box.box),setTimeout(function(){MONSTER.Common.showTutorial(this.game)},700),this.next_round()},MONSTER.ShooterGame.prototype.move=function(){if(this.snowball.thrown){var t=this.snowball,e=this.game.timeSinceLastFrame,i=t.sprite;if(i.position.x=t.pos[0],i.position.y=t.pos[1],t.time+=e,t.time<this.SNOWBALL_TIME){var s=MONSTER.Utils.bezier(t.time/this.SNOWBALL_TIME,[{x:t.src[0],y:t.src[1]},{x:(t.src[0]+t.dest[0])/2,y:(t.src[1]+t.dest[1])/2},{x:t.dest[0],y:t.dest[1]}]);i.position.x=s.x,i.position.y=s.y;var o=this.SNOWBALL_TIME/2/t.time;i.visible=o<4,i.scale.x=i.scale.y=o,this.checkHit(i.position.x,i.position.y)}else this.resetSnowball(this.snowball)}},MONSTER.ShooterGame.prototype.resetSnowball=function(t){t.sprite.anchor.x=t.sprite.anchor.y=.5,t.src=[0,0],t.pos=[0,0],t.time=0,t.thrown=!1},MONSTER.ShooterGame.prototype["throw"]=function(){var t=this.snowball;if(!t.thrown){t.thrown=!0;var e=MONSTER.linear(this.crosshair.position.x,0,this.game.width,.2*this.game.width,.8*this.game.width),i=this.game.height+t.sprite.height;t.src=[e,i],t.pos=[e,i],t.dest=[this.crosshair.position.x,this.crosshair.position.y]}},MONSTER.ShooterGame.prototype.checkHit=function(t,e){if(!this.hit)for(var i=0;i<this.answers.length;i++){var s=this.answers[i];if(MONSTER.Utils.isPointInRectWithTol(t,e,[s.text.position.x,s.text.position.y,s.text.width,s.text.height],[20,40])){this.game.tweens.push(new MONSTER.Tween(s.text,"position.y",(-200),1e3)),this.game.tweens.push(new MONSTER.Tween(s.text,"position.x",MONSTER.Utils.getRandomInt(.2*this.game.width,.8*this.game.width),1e3));var o=MONSTER.Common.getAnswersMinusCurrent(this.answers,s);this.hit=!0,this.removeAnswers(o),s.word===this.answer?MONSTER.Common.correct(this):MONSTER.Common.negative(this)}}},MONSTER.ShooterGame.prototype.removeAnswers=function(t){this.game.tweens.push(new MONSTER.Tween(this.top_bar,"position.y",this.top_bar_y.hide,1e3));for(var e=0;e<t.length;e++){var i=t[e];i.text.position.x<this.game.width/2?this.game.tweens.push(new MONSTER.Tween(i.text,"position.x",-i.text.width/2,1e3)):this.game.tweens.push(new MONSTER.Tween(i.text,"position.x",this.game.width+i.text.width/2,1e3))}},MONSTER.ShooterGame.prototype.resultScreen=function(t){MONSTER.GoodWrongScreen.prepare(this,t)},MONSTER.ShooterGame.prototype.next_round=function(){return this.answers.length=0,this.game.tweens.length=0,MONSTER.Common.getWordSet(this)?(this.top_bar_text.text=this.question,this.top_bar_text.position.x=(this.game.width-this.top_bar_text.width)/2,this.hit&&(this.game.tweens.push(new MONSTER.Tween(this.box.box,"position.x",this.result_screen_x.left,1e3)),setTimeout(this.activateShipAgain.bind(this),1500)),this.game.tweens.push(new MONSTER.Tween(this.top_bar,"position.y",this.top_bar_y.show,1e3)),this.createAnswer(this.choices[0],0),this.createAnswer(this.choices[1],1),this.createAnswer(this.choices[2],2),this.createAnswer(this.choices[3],3),void(this.hit=!1)):(MONSTER.Common.showCursor(),MONSTER.Common.endScreen(this))},MONSTER.ShooterGame.prototype.activateShipAgain=function(){this.shipActive=!0},MONSTER.ShooterGame.prototype.createAnswer=function(t,e){var i=this,s=this.rects[e],o=[this.sizes[22],this.sizes[16],this.sizes[12]],n=0,h=new PIXI.Text(t,o[n]),a=150;MONSTER.Common.secure_answer_size(h,o,a);var r=function(){h.position.x=1*Math.floor(Math.random()*s.width+s.x)+1.3*this.game.width,h.position.y=Math.floor(Math.random()*s.height+s.y),h.anchor.x=h.anchor.y=.5,i.game.view.addChild(h);var e={word:t,text:h};i.answers.push(e)};r()},MONSTER.Game=function(t){this.requestId=void 0,this.res=[[800,450]],this.games=window.games,this.current_game="",this.pause=!1,this.game_tmp={},this.level_id=0,this.max_rounds=20;for(var e=0;e<this.games.length;e++)this.game_tmp[game]=null;if(this.data=window.data,this.initStage(),MONSTER.initFonts([MONSTER.Const.DEFAULT_FONT_FAMILY],[MONSTER.Const.COLOURS.navy,MONSTER.Const.COLOURS.white],["36","30","26","22","16","12"]),this.tweens=[],this.assets={simple:{},runner:{runner_run:"/static/images/games/runner/panda_run.png",runner_jump:"/static/images/games/runner/panda_jump.png",runner_far_background:"/static/images/games/runner/far_background.png",runner_background:"/static/images/games/runner/background.png",runner_trees:"/static/images/games/runner/trees.png",runner_foreground:"/static/images/games/runner/foreground.png",runner_ground:"/static/images/games/runner/ground.png"},shooter:{shooter_background:"/static/images/games/shooter/background.png",shooter_clouds:"/static/images/games/shooter/clouds.png",shooter_middle:"/static/images/games/shooter/middle.png",shooter_foreground:"/static/images/games/shooter/foreground.png",shooter_snowball:"/static/images/games/shooter/snowball.png",shooter_crosshair:"/static/images/games/shooter/crosshair.png"},plane:{plane_sky:"/static/images/games/plane/sky.png",plane_background:"/static/images/games/plane/background.png",plane_hills:"/static/images/games/plane/hills.png",plane_valley:"/static/images/games/plane/valley.png",plane_plane:"/static/images/games/plane/crazy_plane.png"},space:{space_ocean:"/static/images/games/space/ocean.png",space_clouds:"/static/images/games/space/clouds.png",space_plane:"/static/images/games/space/plane.png",space_plane_left:"/static/images/games/space/plane_left.png",space_plane_right:"/static/images/games/space/plane_right.png"},ui:{ui_btn_info:"/static/images/games/information.png",ui_star:"/static/images/games/star.png",ui_dark_star:"/static/images/games/dark_star.png"}},this.loaded=!1,this.g=$("#game"),this.g.focus(),this.parent=this.g.parent(),this.resolutionOK=!1,window.canvas_only?this.renderer=new PIXI.CanvasRenderer(0,0):this.renderer=new PIXI.autoDetectRenderer(0,0),this.resize(),window.debug){this.DEBUG=!0;var i=MONSTER.getFonts(MONSTER.Const.DEFAULT_FONT_FAMILY,MONSTER.Const.COLOURS.white);this.debug={fps_text:new PIXI.Text("",i[16]),fps_ticks:1,fps:0,fps_timer:0},this.debug.fps_text.position.y=this.height-18,this.top.addChild(this.debug.fps_text)}this.lastTime=Date.now(),this.timeSinceLastFrame=0,this.requestedFrameRate=1e3/t,window.addEventListener("orientationchange",this.resize.bind(this),!1),window.addEventListener("resize",this.resize.bind(this),!1),this.isWebGL=this.renderer instanceof PIXI.WebGLRenderer,document.getElementById("game").appendChild(this.renderer.view),this.initRandomGame()},MONSTER.Game.prototype.constructor=MONSTER.Game,MONSTER.Game.prototype.setStopFunc=function(t,e,i){this.stopTimer=0,this.stopFunc=t,this.stopTime=e,this.stopBind=i},MONSTER.Game.prototype.resetStopFunc=function(){this.stopTimer=0,this.stopFunc=null,this.stopTime=0,this.stopBind=null},MONSTER.Game.prototype.kick_off=function(){this.stop();var t=Math.floor(Math.random()*this.games.length),e=this.games[t];this.current_game=e,"simple"==e?this.currentScreen=new MONSTER.SimpleGame(this):"space"==e?this.currentScreen=new MONSTER.SpaceGame(this):"plane"==e?this.currentScreen=new MONSTER.PlaneGame(this):"runner"==e?this.currentScreen=new MONSTER.RunnerGame(this):"shooter"==e&&(this.currentScreen=new MONSTER.ShooterGame(this)),this.start()},MONSTER.Game.prototype.initRandomGame=function(){this.stop(),this.current_game=game,this.currentScreen=new MONSTER.LoadingScreen(this),this.start()},MONSTER.Game.prototype.initStage=function(){this.stage=new PIXI.Container,this.background=new PIXI.Graphics,this.top=new PIXI.Graphics,this.view=new PIXI.Container,this.stage.addChild(this.background),this.stage.addChild(this.view),this.stage.addChild(this.top)},MONSTER.Game.prototype.next_level=function(){var t=this.word_sets.data,e=t.length;this.level_id+1==e&&(this.level_id=0),this.to_ask=t[this.level_id].to_ask.slice(),this.all=this.to_ask.slice(),this.rounds=this.to_ask.length,this.actual_rounds=Math.min(this.rounds,this.max_rounds),this.points=0,this.round_id=0,this.to_repeat=[],this.learned=[]},MONSTER.Game.prototype.resize=function(){this.resolutionOK=!1;var t=this.parent.width();this.width=0,this.height=0;for(var e=0;e<this.res.length;e++){var i=this.res[e][0],s=this.res[e][1];if(i<t){this.width=i,this.height=s,this.resolutionOK=!0;break}}this.scaleX=this.width/800,this.scaleY=this.height/450,this.view.scale.x=this.scaleX,this.view.scale.y=this.scaleY,this.background.scale.x=this.scaleX,this.background.scale.y=this.scaleY,this.resolutionOK?($("#alert-browser-size").hide(),this.renderer.resize(this.width,this.height)):($("#alert-browser-size").show(),this.renderer.resize(0,0))},MONSTER.Game.prototype.frameRate=function(){var t=Date.now();this.timeSinceLastFrame=t-this.lastTime,this.lastTime=t},MONSTER.Game.prototype.update=function(){if(this.currentScreen&&!this.pause){this.currentScreen.update();for(var t=0;t<this.tweens.length;t++)this.tweens[t].update(this.timeSinceLastFrame);this.stopFunc&&(this.stopTimer+=this.timeSinceLastFrame,this.stopTimer>this.stopTime&&(this.stopFunc.call(this.stopBind),this.resetStopFunc()))}},MONSTER.Game.prototype.start=function(){void 0===this.requestId&&this.draw()},MONSTER.Game.prototype.stop=function(){void 0!==this.requestId&&(MONSTER.Common.cancelAnimationFrame(this.requestId),this.requestId=void 0)},MONSTER.Game.prototype.draw=function(){this&&this.renderer&&(this.update(),this.renderer.render(this.stage),this.frameRate()),this.requestId=requestAnimationFrame(this.draw.bind(this))};var game=null;window.onload=function(){window.play&&newGame()};